(()=>{var e={};e.id=462,e.ids=[462],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6573:(e,t,o)=>{"use strict";o.r(t),o.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>d,routeModule:()=>h,tree:()=>c}),o(4578),o(429),o(4947),o(5866);var r=o(3191),n=o(8716),s=o(7922),i=o.n(s),a=o(5231),l={};for(let e in a)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>a[e]);o.d(t,l);let c=["",{children:["booking",{children:["success",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(o.bind(o,4578)),"C:\\Users\\ASUS\\OneDrive\\Desktop\\awp mini proj\\app\\booking\\success\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(o.bind(o,429)),"C:\\Users\\ASUS\\OneDrive\\Desktop\\awp mini proj\\app\\layout.tsx"],loading:[()=>Promise.resolve().then(o.bind(o,4947)),"C:\\Users\\ASUS\\OneDrive\\Desktop\\awp mini proj\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(o.t.bind(o,5866,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\ASUS\\OneDrive\\Desktop\\awp mini proj\\app\\booking\\success\\page.tsx"],m="/booking/success/page",u={require:o,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/booking/success/page",pathname:"/booking/success",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},8687:(e,t,o)=>{Promise.resolve().then(o.t.bind(o,9404,23))},4578:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>a});var r=o(9510),n=o(7371),s=o(6039);async function i(){try{let e=await (0,s.s)(),[t,o]=await Promise.all([e.countDocuments(),e.find({},{projection:{customerName:1,customerEmail:1,customerPhone:1,createdAt:1}}).sort({createdAt:-1}).limit(12).toArray()]);return{total:t,recent:o.map(e=>({id:e._id?.toString()??"",name:e.customerName,email:e.customerEmail,phone:e.customerPhone,createdAt:e.createdAt})),error:null}}catch(o){console.error("Booking success snapshot error:",o);let e=o?.message||String(o),t="Unable to connect to the booking database.";return e.includes("MONGODB_URI")||e.includes("Missing")?t="MongoDB connection string not configured. Please add MONGODB_URI to your .env.local file.":(e.includes("connection")||e.includes("connect"))&&(t="Database connection failed. Please check your MongoDB connection string and network."),{total:0,recent:[],error:t}}}async function a({searchParams:e}){let t=await i(),o=new URLSearchParams;["movie","title","date","time","screen","seats","total"].forEach(t=>{let r=e[t];"string"==typeof r&&r&&o.set(t,r)});let s=o.toString()?`/booking/summary?${o.toString()}`:null;return(0,r.jsxs)("section",{className:"mx-auto max-w-5xl space-y-8",children:[(0,r.jsxs)("div",{className:"glass-panel rounded-3xl border border-green-500/30 bg-green-500/10 p-8 text-center",children:[r.jsx("p",{className:"text-xs uppercase tracking-[0.35em] text-green-200/70",children:"Booking Confirmed"}),r.jsx("h1",{className:"mt-3 text-3xl font-bold text-white",children:"Thanks for booking with TicketLoJao!"}),r.jsx("p",{className:"mt-2 text-white/70",children:"You're part of a community of movie lovers. Here's a snapshot of everyone who booked with you."}),(0,r.jsxs)("div",{className:"mt-6 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-center",children:[(0,r.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-white/5 px-6 py-4",children:[r.jsx("p",{className:"text-sm text-white/60",children:"Total successful bookings"}),r.jsx("p",{className:"text-4xl font-black text-green-400",children:t.error?"--":t.total.toLocaleString("en-IN")})]}),s&&r.jsx(n.default,{href:s,className:"rounded-full border border-white/10 bg-white/10 px-6 py-3 text-sm font-semibold text-white transition hover:bg-white/20",children:"View Booking Summary"}),r.jsx(n.default,{href:"/booking",className:"rounded-full border border-white/10 bg-purple-500/20 px-6 py-3 text-sm font-semibold text-white transition hover:bg-purple-500/30",children:"Book Another Show"})]})]}),t.error?r.jsx("div",{className:"rounded-3xl border border-red-500/30 bg-red-500/10 p-6 text-red-100",children:r.jsx("p",{children:t.error})}):(0,r.jsxs)("div",{className:"glass-panel space-y-4 rounded-3xl border border-white/10 p-6",children:[r.jsx("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{children:[r.jsx("h2",{className:"text-2xl font-semibold text-white",children:"Recent moviegoers"}),r.jsx("p",{className:"text-sm text-white/60",children:"Name, email, and phone numbers from the latest bookings."})]})}),0===t.recent.length?r.jsx("p",{className:"text-sm text-white/60",children:"No bookings recorded yet. Be the first to book a show!"}):r.jsx("div",{className:"grid gap-3 md:grid-cols-2",children:t.recent.map(e=>(0,r.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-4 text-sm text-white/80",children:[r.jsx("p",{className:"text-base font-semibold text-white",children:e.name}),r.jsx("p",{className:"mt-1 text-white/60",children:e.email}),r.jsx("p",{className:"text-white/60",children:e.phone})]},e.id))})]})]})}},6039:(e,t,o)=>{"use strict";o.d(t,{s:()=>c});let r=require("mongodb"),n=process.env.MONGODB_URI,s=process.env.MONGODB_DB??"awp-mini-proj",i=null;if(!n)throw Error("Missing MONGODB_URI environment variable. Please add it to your Vercel environment variables or .env.local file.");let a={maxPoolSize:1,minPoolSize:1,serverSelectionTimeoutMS:5e3,socketTimeoutMS:45e3,connectTimeoutMS:1e4,retryWrites:!0,retryReads:!0,directConnection:!1,compressors:["zlib"]};if(!global._mongoClientPromise){let e=new r.MongoClient(n,a);global._mongoClientPromise=e.connect().then(e=>e).catch(e=>{global._mongoClientPromise=null;let t=e.message||String(e);if(t.includes("authentication")||t.includes("credentials"))throw Error("MongoDB authentication failed. Check your username and password.");if(t.includes("ENOTFOUND")||t.includes("getaddrinfo"))throw Error("Cannot reach MongoDB server. Check your network and cluster address.");if(t.includes("timeout"))throw Error("Connection timeout. Check MongoDB Atlas IP whitelist (allow 0.0.0.0/0 for Vercel).");throw Error(`MongoDB connection failed: ${t}`)})}async function l(){i||(i=new r.MongoClient(n,a).connect());try{return await i}catch(e){throw global._mongoClientPromise=null,e}}async function c(){try{let e=(await l()).db(s).collection("bookings");if(!global._mongoIndexCreated)try{await e.createIndex({createdAt:-1},{background:!0}),global._mongoIndexCreated=!0}catch(e){e.message?.includes("already exists")||e.message?.includes("IndexOptionsConflict")||console.warn("Index creation warning:",e.message),global._mongoIndexCreated=!0}return e}catch(e){throw console.error("MongoDB collection error:",e),Error(`Database operation failed: ${e.message||"Unknown error"}`)}}i=global._mongoClientPromise}};var t=require("../../../webpack-runtime.js");t.C(e);var o=e=>t(t.s=e),r=t.X(0,[276,123,318],()=>o(6573));module.exports=r})();